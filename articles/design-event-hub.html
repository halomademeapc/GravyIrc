<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>The Event Hub </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="The Event Hub ">
    <meta name="generator" content="docfx 2.51.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="the-event-hub">The Event Hub</h1>

<h2 id="methodology">Methodology</h2>
<p>The <a href="/api/GravyIrc.EventHub.html">EventHub</a> has been substantially rewritten from its origins in NetIRC but provides similar functionality.</p>
<h3 id="the-problem">The Problem</h3>
<p>The original hub had an event for each implementation of <a href="/api/GravyIrc.Messages.IServerMessage.html">IServerMessage</a> that was present in the library.  This had the drawbacks of limiting available events to only messages defined within the NetIRC library and added the need for a lot of additional, mostly copy-pasted code to be added for each type of message that is added.</p>
<h3 id="my-approach">My Approach</h3>
<p>To avoid this shortcomings, I changed the event hub to dynamically create and provide event handlers as needed.  This cuts back on the amount of code that must be added for each type of message and means that users of the library can extend its in-built message types with additional ones at runtime.  My background is in web development with MVC so I'm not especially familiar with C# events.  If you have an idea for a nicer way of handling this, please let me know.</p>
<h4 id="subscribing-to-an-incoming-message-event">Subscribing to an Incoming Message Event</h4>
<p>You can add actions to be taken when a message of a certain type comes in with lambdas or method references.</p>
<pre><code class="lang-csharp">myClient.EventHub.Subscribe&lt;PrivateMessage&gt;((client, args) =&gt; Console.WriteLine(args.IrcMessage.Message));
</code></pre>
<h3 id="registering-additional-message-types">Registering Additional Message Types</h3>
<p>If the type of message you want to listen for isn't in GravyIrc yet, open a pull request!  Please open a pull request :)</p>
<p>If you want to extend things on your end, I've made it easy to do that was well.  You'll need a class that extends <a href="/api/GravyIrc.Messages.IrcMessage.html">IrcMessage</a> and implements <a href="/api/GravyIrc.Messages.IServerMessage.html">IServerMessage</a>. You can decorate it with a <a href="/api/GravyIrc.Attributes.ServerMessageAttribute.html">ServerMessageAttribute</a> to specify which IRC command it should be bound to.</p>
<pre><code class="lang-csharp">[ServerMessage(&quot;POTATO&quot;)]
public class PotatoMessage : IrcMessage, IServerMessage
{
    ...
}
</code></pre>
<p>Once you have your class ready, register it to <a href="/api/GravyIrc.Messages.IrcMessage.html">IrcMessage</a> so that incoming messages with that command will be converted to your type and you'll be able to subscribe to events for it.</p>
<pre><code class="lang-csharp">IrcMessage.RegisterServerMessageType&lt;PotatoMessage&gt;();
myClient.EventHub.Subscribe&lt;PotatoMessage&gt;((client, args) =&gt; Console.WriteLine(&quot;Potatoes are cool!&quot;));
</code></pre>
<p>After that you should be good to go!</p>
<p>If you don't want to use the annotation to specify command, overloads are provided on IrcMessage.</p>
<pre><code class="lang-csharp">IrcMessage.RegisterServerMessageType&lt;CarrotMessage&gt;(&quot;CARROT&quot;);
</code></pre>
<p>See <a href="/articles/guide-add-server-message.html">Adding a server message type</a> for more details on this process.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/halomademeapc/GravyIrc/blob/ba155c17cd44ff17b0e72e17171a6d6f2b2020d1/docfx_project/articles/design-event-hub.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
